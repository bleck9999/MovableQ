{% extends "layouts/base.html" %}

{% block title %}{{ site_title }} - Mining Job{% endblock %}

{% block content %}
	<div class="alert alert-info" role="alert">
		If you have any issues, try refreshing the page. You can also ask for help on the <a class="link-info" href="{{ discord_url }}">{{ discord_name }} Discord</a>.
	</div>
	<div class="d-grid gap-3">
		<div class="card">
			<h4 class="card-header">Welcome to {{ site_title }}!</h4>
			<div class="card-body">
				<p class="card-text">
					Welcome to <strong>{{ site_title }}</strong>, a service made possible by volunteers with powerful GPUs! This site helps to obtain your console's unique encryption key (<code>movable.sed</code>) by bruteforcing it with a powerful GPU. To get started, choose a method below.
				</p>
			</div>
		</div>
		<div>
			<div class="card">
				<h4 class="card-header">Step 1: Choose a Method</h4>
				<div id="methodCard" class="collapse show">
					<form id="methodForm" class="card-body">
						<div class="mb-3 row g-3" id="methodCardGroup">
							<div class="col-md-6">
								<button type="button" class="card btn p-0 text-start focus-ring border-primary" id="methodCardFc">
									<div class="card-body">
										<input type="radio" class="btn-check" name="methodRadio" id="methodButtonFc" checked autocomplete="off">
										<h5 class="card-title"><label for="methodButtonFc">Friend Code Mining</label></h5>
										<p class="card-text">
											This uses the data obtained from a two-way friend exchange as a starting point for bruteforcing.
										</p>
									</div>
								</button>
							</div>
							<div class="col-md-6">
								<button type="button" class="card btn p-0 text-start focus-ring border-secondary-subtle" id="methodCardMii">
									<div class="card-body">
										<input type="radio" class="btn-check" name="methodRadio" id="methodButtonMii" autocomplete="off">
										<h5 class="card-title"><label for="methodButtonMii">Mii Mining</label></h5>
										<p class="card-text">
											This uses a Mii QR code instead of a two-way friend exchange, but is significantly more time-consuming.
										</p>
									</div>
								</button>
							</div>
						</div>
						<button type="submit" class="btn btn-success">Get started <i class="fa-solid fa-arrow-right"></i></button>
					</form>
				</div>
			</div>
			<div class="card">
				<h4 class="card-header">Step 2: Console Information</h4>
				<div id="methodCard" class="collapse show">
				</div>
			</div>
			<div class="card">
				<h4 class="card-header">Step 3: Mining</h4>
				<div id="methodCard" class="collapse show">
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="canceledModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Mining Canceled</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<p>The mining job was canceled, either in another tab or by an administrator.</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Dismiss</button>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="failedModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Mining Failed</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<p>We were not able to successfully complete your mining request. To resolve the issue, please first verify that you entered all information correctly:</p>
					<ul>
						<li>Ensure you entered the correct ID0 by copy-pasting the 32-character folder name inside your &quot;Nintendo 3DS&quot; folder. If you have multiple, follow the steps <a href="{{ id0_help_url }}">here</a> to determine the correct one.</li>
						<li>Ensure that your Mii QR code belongs to the console you are attempting to mine for.</li>
						<li>Ensure you selected the correct model for your console. As a reference, new consoles have 4 shoulder buttons (L,ZL,ZR,R), while old consoles only have 2 (L,R).</li>
					</ul>
					<p>If you are sure all information is correct and the job still cannot be completed, please reach out on the <a class="link" href="{{ discord_url }}">{{ discord_name }} Discord</a>.</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Dismiss</button>
				</div>
			</div>
		</div>
	</div>	
	<script type="module" src="{{ url_for('serve_js', filename='client.js') }}"></script>
{% endblock %}
